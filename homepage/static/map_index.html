<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Explorer: Reebo</title>

  <!-- Tailwind CDN with plugin -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

  <!-- Custom font: Fira Sans -->
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;700&display=swap" rel="stylesheet">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Fira Sans"', 'sans-serif']
          }
        }
      }
    }
  </script>

  <style>
    .leaflet-tile-pane {
      filter: contrast(1.1) saturate(0.9) brightness(1.05);
    }
    .leaflet-tile {
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }
  </style>
</head>
<body class="font-sans bg-[#0d1117] text-gray-100 flex flex-col items-center min-h-screen">

  <!-- Header -->
  <header class="text-center mt-8">
    <h1 class="text-3xl font-bold">Explore What I Explored</h1>
    <p class="text-gray-400 mt-2">A hand-drawn pixel map of everywhere I’ve studied, worked, and wandered.</p>
  </header>

  <!-- Map container -->
  <main id="map-wrapper" class="w-[90vw] max-w-5xl h-[70vh] mt-6 border border-pink-500 shadow-2xl rounded-2xl overflow-hidden">
    <div id="map" class="w-full h-full"></div>
  </main>

  <!-- Back button -->
  <div class="mt-4">
    <a href="/" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded transition">
      Go Back
    </a>
  </div>

  <!-- Footer -->
  <footer class="text-center text-xs text-gray-500 mt-6 mb-4 px-4">
    <p>
      Credits: tiles & markers by me or from free-use sources —
      <a href="https://pixelgnome.itch.io/fish" class="underline hover:text-gray-400">pixelgnome</a>,
      <a href="https://faithfulpack.net/" class="underline hover:text-gray-400">Faithful Pack</a>,
      <a href="https://shubibubi.itch.io/nature-things" class="underline hover:text-gray-400">shubibubi</a>,
      <a href="https://dustdfg.itch.io/pixel-art-top-down-rocks-pack" class="underline hover:text-gray-400">dustdfg</a>,
      <a href="http://pop-shop-packs.itch.io/beach-items-item-pixel-asset-pack" class="underline hover:text-gray-400">Pop Shop</a>,
      <a href="https://jennpixel.itch.io/free-flower-pack-12-icons" class="underline hover:text-gray-400">JennPixel</a>.
    </p>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const IMG_W = 15872;
    const IMG_H = 15872;
    const TILE = 256;
    const maxZ = Math.ceil(Math.log2(Math.max(IMG_W, IMG_H) / TILE));

    const map = L.map("map", {
      crs: L.CRS.Simple,
      minZoom: 0,
      maxNativeZoom: maxZ,
      maxZoom: maxZ * 2,
      zoomSnap: 1,
      fadeAnimation: false
    });

    const sw = map.unproject([0, IMG_H], maxZ);
    const ne = map.unproject([IMG_W, 0], maxZ);
    const bounds = new L.LatLngBounds(sw, ne);

    const center = map.unproject([IMG_W / 2, IMG_H / 2], maxZ);
    map.setView(center, maxZ - 4);
    map.setMaxBounds(bounds);

    L.tileLayer("/tiles/{z}/{x}/{y}.png", {
      tileSize: TILE,
      bounds: bounds,
      maxNativeZoom: maxZ,
      maxZoom: maxZ * 2,
      noWrap: true
    }).addTo(map);

    const markers = [
      { coords: [4255, 6045], title: "Salesiani Sesto", desc: "High school near Milan. I followed the ICT track — here I started my coding journey." },
      { coords: [5468, 4985], title: "Politecnico di Milano", desc: "Where I did my Bachelor's in Computer Engineering. I also started my Data Science Master's, as part of the EIT Digital double degree." },
      { coords: [8112, 4578], title: "TUM Summer School", desc: "Spent two weeks in Munich at TUM for a summer school on resilient systems for Industrial IoT. Quite intense." },
      { coords: [9714, 3524], title: "Aalto University", desc: "Second year of my Data Science Master's. Lived in Helsinki — saw a lot of snow and saunas. And easy Lapland trips." },
      { coords: [13865, 7733], title: "Scuderia Ferrari", desc: "Where I work now. I do Data Science and Software Engineering in the F1 aerodynamics department." },
      { coords: [13750, 10945], title: "Singapore (RecSys 2023)", desc: "Went to Singapore after winning the ACM RecSys 2023 academic challenge. It was surreal — humid, exciting, unforgettable." },
      { coords: [9279, 13157], title: "Milan (Home)", desc: "My hometown. Where it all started, and where I still go back to recharge." }
    ];

    const pixelIcon = L.icon({
      iconUrl: "/static/img/marker.png",
      iconSize: [32, 32],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    markers.forEach(({ coords, title, desc }) => {
      const latlng = map.unproject(coords, maxZ);
      L.marker(latlng, { icon: pixelIcon }).addTo(map)
        .bindPopup(`<div class="text-sm font-medium text-gray-800"><strong>${title}</strong><br><span class="text-gray-600">${desc}</span></div>`);
    });
  </script>
</body>
</html>
